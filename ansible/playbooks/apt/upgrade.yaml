- name: Install/Upgrade and configure Docker
  hosts: all
  become: true
  tasks:
  - name: Install/Upgrade Docker
    ansible.builtin.apt:
      name: docker.io
      update_cache: yes
      state: absent
  # - name: Start Docker service
  #   ansible.builtin.systemd:
  #     name: docker
  #     enabled: yes
  #     state: started
  # - name: Add user to docker group
  #   ansible.builtin.user:
  #     name: "{{ ansible_user }}"
  #     groups: docker
  #     append: yes

- name: Install other packages
  hosts: all
  become: true
  tasks:
  - name: Upgrade packages
    ansible.builtin.apt:
      update_cache: yes
      upgrade: "safe"
  - name: Install packages
    ansible.builtin.apt:
      autoremove: yes
      pkg:
        - smartmontools
        - ubuntu-drivers-common
